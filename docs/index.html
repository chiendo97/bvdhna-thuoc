<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hướng dẫn hiệu chỉnh liều kháng sinh</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: #525659;
        }

        .header {
            padding: 0.75rem 1rem;
            background: #323639;
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
            border: none;
            border-radius: 4px;
            background: #525659;
            color: #fff;
            outline: none;
        }

        .search-input::placeholder {
            color: #aaa;
        }

        .search-input:focus {
            background: #626669;
        }

        .drug-select {
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
            min-width: 250px;
            border: none;
            border-radius: 4px;
            background: #525659;
            color: #fff;
            cursor: pointer;
        }

        .nav-buttons {
            display: flex;
            gap: 0.25rem;
        }

        .nav-btn {
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
            border: none;
            border-radius: 4px;
            background: #525659;
            color: #fff;
            cursor: pointer;
            transition: background 0.2s;
        }

        .nav-btn:hover {
            background: #626669;
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .entry-info {
            font-size: 0.85rem;
            color: #aaa;
            white-space: nowrap;
        }

        .zoom-controls {
            display: flex;
            gap: 0.25rem;
            align-items: center;
        }

        .zoom-btn {
            padding: 0.5rem 0.75rem;
            font-size: 0.9rem;
            border: none;
            border-radius: 4px;
            background: #525659;
            color: #fff;
            cursor: pointer;
            transition: background 0.2s;
        }

        .zoom-btn:hover {
            background: #626669;
        }

        .zoom-level {
            color: #aaa;
            font-size: 0.85rem;
            min-width: 50px;
            text-align: center;
        }

        .viewer {
            flex: 1;
            overflow: auto;
            display: flex;
            justify-content: center;
            padding: 20px;
            background: #525659;
        }

        .viewer img {
            max-width: 100%;
            height: auto;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            background: white;
            transform-origin: top center;
        }

        .loading {
            color: #aaa;
            font-size: 1.2rem;
            padding: 2rem;
            text-align: center;
        }

        .no-results {
            color: #aaa;
            font-size: 1.2rem;
            padding: 2rem;
            text-align: center;
        }

        .error {
            color: #f88;
            font-size: 1.2rem;
            padding: 2rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="header">
        <input type="text" class="search-input" id="search" placeholder="Tìm kiếm thuốc...">
        <select class="drug-select" id="drugSelect">
            <option value="0" data-name="acyclovir">Acyclovir</option>
            <option value="1" data-name="amikacin">Amikacin</option>
            <option value="2" data-name="amoxicillin">Amoxicillin</option>
            <option value="3" data-name="anidulafungin">Anidulafungin</option>
            <option value="4" data-name="azithromycin">Azithromycin</option>
            <option value="5" data-name="caspofungin">Caspofungin</option>
            <option value="6" data-name="cefaclor">Cefaclor</option>
            <option value="7" data-name="cefalexin">Cefalexin</option>
            <option value="8" data-name="cefamandol">Cefamandol</option>
            <option value="9" data-name="cefazolin">Cefazolin</option>
            <option value="10" data-name="cefdinir">Cefdinir</option>
            <option value="11" data-name="cefepim">Cefepim</option>
            <option value="12" data-name="cefixim">Cefixim</option>
            <option value="13" data-name="cefoperazon">Cefoperazon</option>
            <option value="14" data-name="cefoperazon + sulbactam">Cefoperazon + sulbactam</option>
            <option value="15" data-name="cefotaxim">Cefotaxim</option>
            <option value="16" data-name="cefotiam">Cefotiam</option>
            <option value="17" data-name="cefpirom">Cefpirom</option>
            <option value="18" data-name="ceftazidim">Ceftazidim</option>
            <option value="19" data-name="ceftazidim + avibactam">Ceftazidim + avibactam</option>
            <option value="20" data-name="ceftibuten">Ceftibuten</option>
            <option value="21" data-name="ceftizoxim">Ceftizoxim</option>
            <option value="22" data-name="ceftolozan + tazobactam">Ceftolozan + tazobactam</option>
            <option value="23" data-name="ceftriaxon">Ceftriaxon</option>
            <option value="24" data-name="cefuroxim">Cefuroxim</option>
            <option value="25" data-name="ciprofloxacin">Ciprofloxacin</option>
            <option value="26" data-name="clarithromycin">Clarithromycin</option>
            <option value="27" data-name="clindamycin">Clindamycin</option>
            <option value="28" data-name="doripenem">Doripenem</option>
            <option value="29" data-name="doxycyclin">Doxycyclin</option>
            <option value="30" data-name="ertapenem">Ertapenem</option>
            <option value="31" data-name="fluconazol">Fluconazol</option>
            <option value="32" data-name="fosfomycin">Fosfomycin</option>
            <option value="33" data-name="gentamicin">Gentamicin</option>
            <option value="34" data-name="imipenem + cilastatin">Imipenem + cilastatin</option>
            <option value="35" data-name="itraconazol">Itraconazol</option>
            <option value="36" data-name="levofloxacin">Levofloxacin</option>
            <option value="37" data-name="linezolid">Linezolid</option>
            <option value="38" data-name="meropenem">Meropenem</option>
            <option value="39" data-name="metronidazol">Metronidazol</option>
            <option value="40" data-name="moxifloxacin">Moxifloxacin</option>
            <option value="41" data-name="ofloxacin">Ofloxacin</option>
            <option value="42" data-name="piperacilin + tazobactam">Piperacilin + tazobactam</option>
            <option value="43" data-name="co-trimoxazol">Co-trimoxazol</option>
            <option value="44" data-name="ticarcilin + acid clavulanic">Ticarcilin + acid clavulanic</option>
            <option value="45" data-name="tinidazol">Tinidazol</option>
            <option value="46" data-name="tobramycin">Tobramycin</option>
            <option value="47" data-name="vancomycin">Vancomycin</option>
            <option value="48" data-name="voriconazol">Voriconazol</option>
            <option value="49" data-name="colistin">Colistin</option>
        </select>
        <div class="nav-buttons">
            <button class="nav-btn" id="prevBtn" title="Trước">&larr; Trước</button>
            <button class="nav-btn" id="nextBtn" title="Sau">Sau &rarr;</button>
        </div>
        <div class="zoom-controls">
            <button class="zoom-btn" id="zoomOut" title="Thu nhỏ">-</button>
            <span class="zoom-level" id="zoomLevel">100%</span>
            <button class="zoom-btn" id="zoomIn" title="Phóng to">+</button>
            <button class="zoom-btn" id="zoomFit" title="Vừa màn hình">Fit</button>
        </div>
        <span class="entry-info" id="entryInfo"></span>
    </div>
    <div class="viewer" id="viewerContainer">
        <div class="loading">Đang tải...</div>
    </div>

    <script>
        const search = document.getElementById('search');
        const drugSelect = document.getElementById('drugSelect');
        const viewerContainer = document.getElementById('viewerContainer');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const entryInfo = document.getElementById('entryInfo');
        const zoomInBtn = document.getElementById('zoomIn');
        const zoomOutBtn = document.getElementById('zoomOut');
        const zoomFitBtn = document.getElementById('zoomFit');
        const zoomLevelSpan = document.getElementById('zoomLevel');

        // Embedded entries data
        const allEntries = [
  {
    "name": "Acyclovir",
    "file": "Acyclovir.png"
  },
  {
    "name": "Amikacin",
    "file": "Amikacin.png"
  },
  {
    "name": "Amoxicillin",
    "file": "Amoxicillin.png"
  },
  {
    "name": "Anidulafungin",
    "file": "Anidulafungin.png"
  },
  {
    "name": "Azithromycin",
    "file": "Azithromycin.png"
  },
  {
    "name": "Caspofungin",
    "file": "Caspofungin.png"
  },
  {
    "name": "Cefaclor",
    "file": "Cefaclor.png"
  },
  {
    "name": "Cefalexin",
    "file": "Cefalexin.png"
  },
  {
    "name": "Cefamandol",
    "file": "Cefamandol.png"
  },
  {
    "name": "Cefazolin",
    "file": "Cefazolin.png"
  },
  {
    "name": "Cefdinir",
    "file": "Cefdinir.png"
  },
  {
    "name": "Cefepim",
    "file": "Cefepim.png"
  },
  {
    "name": "Cefixim",
    "file": "Cefixim.png"
  },
  {
    "name": "Cefoperazon",
    "file": "Cefoperazon.png"
  },
  {
    "name": "Cefoperazon + sulbactam",
    "file": "Cefoperazon_+_sulbactam.png"
  },
  {
    "name": "Cefotaxim",
    "file": "Cefotaxim.png"
  },
  {
    "name": "Cefotiam",
    "file": "Cefotiam.png"
  },
  {
    "name": "Cefpirom",
    "file": "Cefpirom.png"
  },
  {
    "name": "Ceftazidim",
    "file": "Ceftazidim.png"
  },
  {
    "name": "Ceftazidim + avibactam",
    "file": "Ceftazidim_+_avibactam.png"
  },
  {
    "name": "Ceftibuten",
    "file": "Ceftibuten.png"
  },
  {
    "name": "Ceftizoxim",
    "file": "Ceftizoxim.png"
  },
  {
    "name": "Ceftolozan + tazobactam",
    "file": "Ceftolozan_+_tazobactam.png"
  },
  {
    "name": "Ceftriaxon",
    "file": "Ceftriaxon.png"
  },
  {
    "name": "Cefuroxim",
    "file": "Cefuroxim.png"
  },
  {
    "name": "Ciprofloxacin",
    "file": "Ciprofloxacin.png"
  },
  {
    "name": "Clarithromycin",
    "file": "Clarithromycin.png"
  },
  {
    "name": "Clindamycin",
    "file": "Clindamycin.png"
  },
  {
    "name": "Doripenem",
    "file": "Doripenem.png"
  },
  {
    "name": "Doxycyclin",
    "file": "Doxycyclin.png"
  },
  {
    "name": "Ertapenem",
    "file": "Ertapenem.png"
  },
  {
    "name": "Fluconazol",
    "file": "Fluconazol.png"
  },
  {
    "name": "Fosfomycin",
    "file": "Fosfomycin.png"
  },
  {
    "name": "Gentamicin",
    "file": "Gentamicin.png"
  },
  {
    "name": "Imipenem + cilastatin",
    "file": "Imipenem_+_cilastatin.png"
  },
  {
    "name": "Itraconazol",
    "file": "Itraconazol.png"
  },
  {
    "name": "Levofloxacin",
    "file": "Levofloxacin.png"
  },
  {
    "name": "Linezolid",
    "file": "Linezolid.png"
  },
  {
    "name": "Meropenem",
    "file": "Meropenem.png"
  },
  {
    "name": "Metronidazol",
    "file": "Metronidazol.png"
  },
  {
    "name": "Moxifloxacin",
    "file": "Moxifloxacin.png"
  },
  {
    "name": "Ofloxacin",
    "file": "Ofloxacin.png"
  },
  {
    "name": "Piperacilin + tazobactam",
    "file": "Piperacilin_+_tazobactam.png"
  },
  {
    "name": "Co-trimoxazol",
    "file": "Co-trimoxazol.png"
  },
  {
    "name": "Ticarcilin + acid clavulanic",
    "file": "Ticarcilin_+_acid_clavulanic.png"
  },
  {
    "name": "Tinidazol",
    "file": "Tinidazol.png"
  },
  {
    "name": "Tobramycin",
    "file": "Tobramycin.png"
  },
  {
    "name": "Vancomycin",
    "file": "Vancomycin.png"
  },
  {
    "name": "Voriconazol",
    "file": "Voriconazol.png"
  },
  {
    "name": "Colistin",
    "file": "Colistin.png"
  }
];

        let currentEntries = [...allEntries];
        let currentScale = 1.0;
        let currentImage = null;

        function updateZoomDisplay() {
            zoomLevelSpan.textContent = Math.round(currentScale * 100) + '%';
        }

        function updateEntryInfo() {
            const currentIndex = drugSelect.selectedIndex;
            const total = drugSelect.options.length;
            if (total > 0) {
                entryInfo.textContent = `${currentIndex + 1} / ${total}`;
            } else {
                entryInfo.textContent = '';
            }
            prevBtn.disabled = currentIndex <= 0;
            nextBtn.disabled = currentIndex >= total - 1;
        }

        function applyZoom() {
            if (currentImage) {
                currentImage.style.transform = `scale(${currentScale})`;
            }
        }

        function updateViewer() {
            const selectedIdx = drugSelect.selectedIndex;
            if (selectedIdx < 0 || currentEntries.length === 0) {
                viewerContainer.innerHTML = '<div class="no-results">Không tìm thấy kết quả</div>';
                updateEntryInfo();
                return;
            }

            viewerContainer.innerHTML = '<div class="loading">Đang tải...</div>';

            const entry = currentEntries[selectedIdx];
            const img = document.createElement('img');
            img.src = 'drugs/' + entry.file;
            img.alt = entry.name;

            img.onload = function() {
                viewerContainer.innerHTML = '';
                viewerContainer.appendChild(img);
                currentImage = img;
                applyZoom();
            };

            img.onerror = function() {
                viewerContainer.innerHTML = '<div class="error">Không thể tải hình ảnh: ' + entry.file + '</div>';
                currentImage = null;
            };

            updateEntryInfo();
        }

        drugSelect.addEventListener('change', () => {
            currentScale = 1.0;
            updateZoomDisplay();
            updateViewer();
        });

        prevBtn.addEventListener('click', () => {
            if (drugSelect.selectedIndex > 0) {
                drugSelect.selectedIndex--;
                currentScale = 1.0;
                updateZoomDisplay();
                updateViewer();
            }
        });

        nextBtn.addEventListener('click', () => {
            if (drugSelect.selectedIndex < drugSelect.options.length - 1) {
                drugSelect.selectedIndex++;
                currentScale = 1.0;
                updateZoomDisplay();
                updateViewer();
            }
        });

        zoomInBtn.addEventListener('click', () => {
            currentScale = Math.min(currentScale + 0.25, 4);
            updateZoomDisplay();
            applyZoom();
        });

        zoomOutBtn.addEventListener('click', () => {
            currentScale = Math.max(currentScale - 0.25, 0.25);
            updateZoomDisplay();
            applyZoom();
        });

        zoomFitBtn.addEventListener('click', () => {
            currentScale = 1.0;
            updateZoomDisplay();
            applyZoom();
        });

        // Debounce function for search
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        const handleSearch = debounce(() => {
            const query = search.value.toLowerCase().trim();

            // Filter entries
            currentEntries = allEntries.filter(entry => entry.name.toLowerCase().includes(query));

            // Rebuild select
            drugSelect.innerHTML = '';
            currentEntries.forEach((entry, idx) => {
                const option = document.createElement('option');
                option.value = idx;
                option.dataset.name = entry.name.toLowerCase();
                option.textContent = entry.name;
                drugSelect.appendChild(option);
            });

            currentScale = 1.0;
            updateZoomDisplay();
            updateViewer();
        }, 150);

        search.addEventListener('input', handleSearch);

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.target === search) return;

            if (e.key === 'ArrowLeft') {
                prevBtn.click();
            } else if (e.key === 'ArrowRight') {
                nextBtn.click();
            } else if (e.key === '+' || e.key === '=') {
                zoomInBtn.click();
            } else if (e.key === '-') {
                zoomOutBtn.click();
            }
        });

        // Initialize
        updateZoomDisplay();
        updateViewer();
    </script>
</body>
</html>